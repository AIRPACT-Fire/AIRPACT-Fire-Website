{% extends "base/newbase.html" %}
{% block airpact-content %}

<table>
  <tr>
    <td>
      <div class = "">  
        <a href ="https://play.google.com/store/apps/details?id=lar.wsu.edu.airpact_fire">
        <image style = " z-index: -1; position: fixed; height:40px;" class = "img-responsive" src = "https://lh3.googleusercontent.com/D2XShm3_4Od4BsH7OhIr8IipoYlYRF8A2N6wlGbL4m2xxi2DGurz6tRom-zaAHpU7Q=w300">  </image> </a>
      </div>
    </td>
    <td>
     <a href ="https://play.google.com/store/apps/details?id=lar.wsu.edu.airpact_fire">
        <div class = "" style= "z-index: -1; position: fixed; text-shadow: 1px 1px 0 #000; font-size: 40px; font-family: Righteous, cursive; color: #fff; left:15%" >
          Welcome to Airpact-Fire</div> 
      </a>
    </td>
  </tr>
</table>
<div id="map" class="" style="height:500px; width: 2000px; border:solid black 1px; "> </div>
 
 <script>
    var pictures = [];
    var markerList = [];
    var infoWindow;
    {% for picture in newestPictures %}
     pictures.push(new picture ("{{picture.thumbnail.url}}", {{picture.geoX}},{{picture.geoY}}, "","{{picture.user}}","{{picture.description}}","/picture/view/" + {{picture.id}}+"/"));
    {% endfor %}

    function picture(thumbnailUrl, lat, long, location, user, description, link)
    {
      this.thumbnailUrl = thumbnailUrl;
      this.lat = lat;
      this.long = long;
      this.location = location;
      this.user = user;
      this.description = description;
      this.link = link;
    }

      function initMap() {
        infoWindow = new google.maps.InfoWindow({ content: "hello" });
        var mapDiv = document.getElementById('map');
        var map = new google.maps.Map(mapDiv, {
          center: {lat: 47.0902, lng: -100.7129 }, 
          zoom: 5
        });

        for(i=0; i < pictures.length; i++)
        {
          markerList.push(new google.maps.Marker({
            map:map,
            draggable:false,
            animation: google.maps.Animation.DROP,
            position:{lat:pictures[i].lat, lng:pictures[i].long},
          })
          );
          var br = "<br />";
          var anchor1 = '<a href="'+pictures[i].link+'">';
          var content = anchor1 +' <img  class="img-responsive" src="' + pictures[i].thumbnailUrl + '" alt="{{ picture.pic.url}}" align = "middle" id ="mainPicture" /> </a>'+
          'User: <a href="user/profile/'+pictures[i].user+'/">'+pictures[i].user +"</a><br> Description: " + pictures[i].description;
          google.maps.event.addListener(markerList[i], 'click', (function(content){
            return function(){
           infoWindow.setPosition(this.getPosition());
           infoWindow.setContent( content );
           infoWindow.open(map);
         };

          })(content));
        }
      }


    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCp587g3ut0dYnLfl2gfeWTc0fAxujtVcw&callback=initMap"></script>

{% endblock %}